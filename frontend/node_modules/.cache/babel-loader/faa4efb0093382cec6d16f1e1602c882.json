{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\salah\\\\Downloads\\\\project - Copie\\\\src\\\\common\\\\header\\\\Search.jsx\";\nimport React, { useState, useEffect } from \"react\";\nimport logo from \"../../components/assets/images/logo.png\";\nimport { Link, useHistory } from \"react-router-dom\"; // React Router v5\nimport AuthService from \"../../components/Autentification/authservice\";\nconst Search = ({\n  CartItem\n}) => {\n  const history = useHistory(); // Change this line\n  const [isLoggedIn, setIsLoggedIn] = useState(false);\n  const [isUser, setIsUser] = useState(false);\n\n  // Check auth status regularly\n  useEffect(() => {\n    const checkAuth = () => {\n      const loggedIn = sessionStorage.getItem('isLoggedIn') === 'true';\n      const userRole = sessionStorage.getItem('userRole');\n      setIsLoggedIn(loggedIn);\n      setIsUser(userRole === 'USER');\n    };\n    checkAuth();\n    // Check auth status every 30 seconds\n    const interval = setInterval(checkAuth, 30000);\n    return () => clearInterval(interval);\n  }, []);\n  const handleLogout = async () => {\n    try {\n      await AuthService.logout();\n      // Clear state\n      setIsLoggedIn(false);\n      setIsUser(false);\n      // Clear session storage\n      sessionStorage.removeItem('isLoggedIn');\n      sessionStorage.removeItem('userRole');\n      // Navigate and reload\n      history.push('/'); // Change this line\n      window.location.reload();\n    } catch (error) {\n      console.error('Logout failed:', error);\n    }\n  };\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"section\", {\n    className: \"search\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 45,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"container c_flex\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 46,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"icon f_flex width\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 49,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Link, {\n    to: \"/wishlist\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 50,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"i\", {\n    className: \"fa-regular fa-heart icon-circle\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 51,\n      columnNumber: 15\n    }\n  })), isLoggedIn && isUser ? /*#__PURE__*/React.createElement(\"div\", {\n    onClick: handleLogout,\n    style: {\n      cursor: 'pointer'\n    },\n    title: \"Logout\",\n    className: \"auth-icon\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 56,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"i\", {\n    className: \"fas fa-sign-out-alt icon-circle\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 17\n    }\n  })) : /*#__PURE__*/React.createElement(Link, {\n    to: \"/register\",\n    className: \"auth-icon\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"i\", {\n    className: \"fa fa-user icon-circle\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 17\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"cart\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Link, {\n    to: \"/cart\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"i\", {\n    className: \"fa fa-shopping-bag icon-circle\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 17\n    }\n  }), /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 17\n    }\n  }, (CartItem === null || CartItem === void 0 ? void 0 : CartItem.length) || 0)))))));\n};\nexport default Search;","map":{"version":3,"names":["React","useState","useEffect","logo","Link","useHistory","AuthService","Search","CartItem","history","isLoggedIn","setIsLoggedIn","isUser","setIsUser","checkAuth","loggedIn","sessionStorage","getItem","userRole","interval","setInterval","clearInterval","handleLogout","logout","removeItem","push","window","location","reload","error","console","createElement","Fragment","className","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber","to","onClick","style","cursor","title","length"],"sources":["C:/Users/salah/Downloads/project - Copie/src/common/header/Search.jsx"],"sourcesContent":["import React, { useState, useEffect } from \"react\"\r\nimport logo from \"../../components/assets/images/logo.png\"\r\nimport { Link, useHistory } from \"react-router-dom\" // React Router v5\r\nimport AuthService from \"../../components/Autentification/authservice\"\r\n\r\nconst Search = ({ CartItem }) => {\r\n  const history = useHistory(); // Change this line\r\n  const [isLoggedIn, setIsLoggedIn] = useState(false);\r\n  const [isUser, setIsUser] = useState(false);\r\n\r\n  // Check auth status regularly\r\n  useEffect(() => {\r\n    const checkAuth = () => {\r\n      const loggedIn = sessionStorage.getItem('isLoggedIn') === 'true';\r\n      const userRole = sessionStorage.getItem('userRole');\r\n      setIsLoggedIn(loggedIn);\r\n      setIsUser(userRole === 'USER');\r\n    };\r\n\r\n    checkAuth();\r\n    // Check auth status every 30 seconds\r\n    const interval = setInterval(checkAuth, 30000);\r\n    return () => clearInterval(interval);\r\n  }, []);\r\n\r\n  const handleLogout = async () => {\r\n    try {\r\n      await AuthService.logout();\r\n      // Clear state\r\n      setIsLoggedIn(false);\r\n      setIsUser(false);\r\n      // Clear session storage\r\n      sessionStorage.removeItem('isLoggedIn');\r\n      sessionStorage.removeItem('userRole');\r\n      // Navigate and reload\r\n      history.push('/'); // Change this line\r\n      window.location.reload();\r\n    } catch (error) {\r\n      console.error('Logout failed:', error);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <section className='search'>\r\n        <div className='container c_flex'>\r\n          {/* ...existing logo and search box code... */}\r\n\r\n          <div className='icon f_flex width'>\r\n            <Link to='/wishlist'>\r\n              <i className='fa-regular fa-heart icon-circle'></i>\r\n            </Link>\r\n\r\n            {/* Simplified conditional rendering */}\r\n            {isLoggedIn && isUser ? (\r\n              <div \r\n                onClick={handleLogout} \r\n                style={{ cursor: 'pointer' }}\r\n                title=\"Logout\"\r\n                className=\"auth-icon\"\r\n              >\r\n                <i className='fas fa-sign-out-alt icon-circle'></i>\r\n              </div>\r\n            ) : (\r\n              <Link to='/register' className=\"auth-icon\">\r\n                <i className='fa fa-user icon-circle'></i>\r\n              </Link>\r\n            )}\r\n\r\n            <div className='cart'>\r\n              <Link to='/cart'>\r\n                <i className='fa fa-shopping-bag icon-circle'></i>\r\n                <span>{CartItem?.length || 0}</span>\r\n              </Link>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </section>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default Search;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}